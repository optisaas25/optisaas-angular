<div class="center-detail-container" *ngIf="!loading && centre">
    <!-- Center Info Card -->
    <mat-card class="center-info-card">
        <mat-card-header>
            <mat-card-title>
                <h2>{{ centre.nom }}</h2>
            </mat-card-title>
            <div class="header-actions">
                <button mat-button [routerLink]="['/p/groups', centre.groupeId]" class="back-button">
                    <mat-icon>arrow_back</mat-icon>
                    <span>Retour</span>
                </button>
            </div>
        </mat-card-header>
        <mat-card-content>
            <div class="info-grid">
                <div class="info-item" *ngIf="centre.description">
                    <strong>Description:</strong>
                    <span>{{ centre.description }}</span>
                </div>
                <div class="info-item" *ngIf="centre.adresse">
                    <strong>Adresse:</strong>
                    <span>{{ centre.adresse }}</span>
                </div>
                <div class="info-item" *ngIf="centre.ville">
                    <strong>Ville:</strong>
                    <span>{{ centre.ville }}</span>
                </div>
                <div class="info-item" *ngIf="centre.telephone">
                    <strong>Téléphone:</strong>
                    <span>{{ centre.telephone }}</span>
                </div>
            </div>
        </mat-card-content>
    </mat-card>

    <!-- Warehouses Card -->
    <mat-card class="warehouses-card">
        <mat-card-header>
            <mat-card-title>
                <h3>Entrepôts ({{ centre.entrepots?.length || 0 }})</h3>
            </mat-card-title>
            <div class="header-actions">
                <button mat-raised-button color="primary" (click)="openCreateWarehouseDialog()">
                    <mat-icon>add</mat-icon>
                    Nouvel Entrepôt
                </button>
            </div>
        </mat-card-header>
        <mat-card-content>
            <table mat-table [dataSource]="centre.entrepots || []"
                *ngIf="centre.entrepots && centre.entrepots.length > 0" class="warehouses-table">
                <!-- Nom Column -->
                <ng-container matColumnDef="nom">
                    <th mat-header-cell *matHeaderCellDef>Nom</th>
                    <td mat-cell *matCellDef="let entrepot">
                        <strong>{{ entrepot.nom }}</strong>
                    </td>
                </ng-container>

                <!-- Type Column -->
                <ng-container matColumnDef="type">
                    <th mat-header-cell *matHeaderCellDef>Type</th>
                    <td mat-cell *matCellDef="let entrepot">
                        <span class="badge" [ngClass]="entrepot.type.toLowerCase()">{{ entrepot.type }}</span>
                    </td>
                </ng-container>

                <!-- Capacite Column -->
                <ng-container matColumnDef="capaciteMax">
                    <th mat-header-cell *matHeaderCellDef>Capacité/Surface</th>
                    <td mat-cell *matCellDef="let entrepot">
                        <span *ngIf="entrepot.capaciteMax">{{ entrepot.capaciteMax }} m³</span>
                        <span *ngIf="entrepot.capaciteMax && entrepot.surface"> / </span>
                        <span *ngIf="entrepot.surface">{{ entrepot.surface }} m²</span>
                        <span *ngIf="!entrepot.capaciteMax && !entrepot.surface">-</span>
                    </td>
                </ng-container>

                <!-- Actions Column -->
                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef style="text-align: right;">Actions</th>
                    <td mat-cell *matCellDef="let entrepot" style="text-align: right;">
                        <button mat-icon-button [matMenuTriggerFor]="menu">
                            <mat-icon>more_vert</mat-icon>
                        </button>
                        <mat-menu #menu="matMenu">
                            <button mat-menu-item [routerLink]="['/p/warehouses', entrepot.id]">
                                <mat-icon class="premium-menu-icon-view">visibility</mat-icon>
                                <span>Visualiser</span>
                            </button>
                            <mat-divider></mat-divider>
                            <button mat-menu-item (click)="openEditWarehouseDialog(entrepot)">
                                <mat-icon class="premium-menu-icon-edit">edit</mat-icon>
                                <span>Modifier</span>
                            </button>
                            <button mat-menu-item (click)="deleteWarehouse(entrepot)">
                                <mat-icon class="premium-menu-icon-delete">delete</mat-icon>
                                <span>Supprimer</span>
                            </button>
                        </mat-menu>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>

            <div *ngIf="!centre.entrepots || centre.entrepots.length === 0" class="no-data">
                <mat-icon>warehouse</mat-icon>
                <p>Aucun entrepôt trouvé</p>
                <button mat-raised-button color="primary" (click)="openCreateWarehouseDialog()">
                    <mat-icon>add</mat-icon>
                    Créer le premier entrepôt
                </button>
            </div>
        </mat-card-content>
    </mat-card>
</div>

<div *ngIf="loading" class="loading">
    <p>Chargement...</p>
</div>